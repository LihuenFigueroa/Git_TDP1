#include "aten.h"

void Aten_Init() {
	//poner aten en 127
	atenActual = 127;

}

void Aten_Write(uint8_t valor) {

	atenActual = 0;

//	ACLARACI0N: Nunca "valor" tendra un valor mayor a 127. Esto se asegura en la funcion
//	"Aten_SetValue", justo antes de llamar a "Aten_Write"
//
//	if (valor & 10000000) {
//
//	} else {
//	}

	if (valor & 01000000) {
		atenActual += 64;
		gpioWrite(ATEN_64, ON);
	} else {
		gpioWrite(ATEN_64, OFF);
	}

	if (valor & 00100000) {
		atenActual += 32;
		gpioWrite(ATEN_32, ON);
	} else {
		gpioWrite(ATEN_32, OFF);
	}

	if (valor & 00010000) {
		atenActual += 16;
		gpioWrite(ATEN_16, ON);
	} else {
		gpioWrite(ATEN_16, OFF);
	}

	if (valor & 00001000) {
		atenActual += 8;
		gpioWrite(ATEN_8, ON);
	} else {
		gpioWrite(ATEN_8, OFF);
	}

	if (valor & 00000100) {
		atenActual += 4;
		gpioWrite(ATEN_4, ON);
	} else {
		gpioWrite(ATEN_4, OFF);
	}

	if (valor & 00000010) {
		atenActual += 2;
		gpioWrite(ATEN_2, ON);
	} else {
		gpioWrite(ATEN_2, OFF);
	}

	if (valor & 00000001) {
		atenActual += 1;
		gpioWrite(ATEN_1, ON);
	} else {
		gpioWrite(ATEN_1, OFF);
	}
}

uint8_t Aten_SetValue(uint8_t valor) {
	if (valor > 127) {
		return 1;
	} else {
		Aten_Write(valor);
	}

	return 0;
}

